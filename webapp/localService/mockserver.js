/*
 * Copyright (C) 2009-2021 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/ui/core/util/MockServer"],function(M){"use strict";var m,p,_="i2d.eam.pmnotification.create.s1/",a=_+"localService/mockdata";var E=["NotificationHeaderSet","NotificationTypeSet","NotificationTypeChangeSet","ContactSet","PMUserDetailsSet"];return{init:function(){var u=jQuery.sap.getUriParameters(),j=jQuery.sap.getModulePath(a),s=jQuery.sap.getModulePath(_+"manifest",".json"),o=jQuery.sap.syncGetJSON(s).data,d=o["sap.app"].dataSources,b=d["EAM_NTF_CREATE"],c=jQuery.sap.getModulePath(_+b.settings.localUri.replace(".xml",""),".xml"),e=/.*\/$/.test(b.uri)?b.uri:b.uri+"/",A=b.settings.annotations;A.forEach(function(f){var g=d[f],U=g.uri,l=jQuery.sap.getModulePath(_+g.settings.localUri.replace(".xml",""),".xml");new M({rootUri:U,requests:[{method:"GET",path:new RegExp(".*"),response:function(x){jQuery.sap.require("jquery.sap.xml");var h=jQuery.sap.sjax({url:l,dataType:"xml"}).data;x.respondXML(200,{},jQuery.sap.serializeXML(h));return true;}}]}).start();});this.createMockServerForFeatureToggleService();this.createMockServerForAttachmentService();m=new M({rootUri:e});M.config({autoRespond:true,autoRespondAfter:(u.get("serverDelay")||1000)});m.simulate(c,{sMockdataBaseUrl:j,bGenerateMissingMockData:true,aEntitySetsNames:E});m.attachAfter("POST",function(f){var g=f.mParameters.oEntity;if(g&&g.NotificationType==="Q3"){throw{"error":{"code":400,"message":{"lang":"en","value":"QUnit Error Message - Notification Type Q3"},"innererror":{"application":{"component_id":"PM","service_namespace":"/SAP/","service_id":"EAM_NTF_CREATE","service_version":"0001"},"longtext_url":"","errordetails":[{"code":400,"message":"QUnit Error Message - Notification Type Q3","longtext_url":"","propertyref":"","severity":"error","transition":false,"target":""}]}}};}else if(g){jQuery.extend(g,{"AttachmentId":"000020000000","NotificationNumber":"20000000","SystemStatus":"Outstanding","DateMonitor":"G","PriorityText":"","TechnicalObjectNumber":"","ReporterUserId":"","NotificationDate":"\/Date(1430870400000)\/","NotificationTime":"PT17H23M10S","UserCanBeNotified":true,"NotificationPhase":"0","PlantSection":"","Completed":false,"Room":"","NotificationTimezone":"CET","TecObjNoLeadingZeros":"","TechnicalObjectTypeDesc":"","ReporterDisplay":"","LastChangedTimestamp":"\/Date(1438872340000)\/","TechnicalObjectType":"","Deleted":false,"Effect":"","EffectText":"","NotificationTimestamp":"\/Date(1430925790000)\/","TechnicalObjectDescription":"","Priority":"","PriorityType":"","Location":""});g.__metadata.uri=g.__metadata.uri.replace(/NotificationHeaderSet(.*)$/,"NotificationHeaderSet('"+g.NotificationNumber+"')");g.__metadata.id=g.__metadata.uri;}},"NotificationHeaderSet");var r=m.getRequests(),R=function(i,f,g){g.response=function(x){x.respond(i,{"Content-Type":"text/plain;charset=utf-8"},f);};};m.setRequests(r);m.start();jQuery.sap.log.info("Running the app with mock data");},createMockServerForAttachmentService:function(){var o=new M({rootUri:"/sap/opu/odata/sap/CV_ATTACHMENT_SRV/"});o.simulate(jQuery.sap.getModulePath(_+"localService/CV_ATTACHMENT_SRV",".xml"),{bGenerateMissingMockData:true,aEntitySetsNames:[]});var r=o.getRequests();r.push({method:"GET",path:new RegExp("GetAllOriginals(.*)"),response:function(x,u){jQuery.sap.log.debug("Incoming request for GetAllOriginals");x.respond(200,{"Content-Type":"application/json;charset=utf-8"},"{\"d\":{\"results\":[]}}");}});r.push({method:"GET",path:new RegExp("GetArchiveLinkAttachments(.*)"),response:function(x,u){jQuery.sap.log.debug("Incoming request for GetArchiveLinkAttachments");x.respond(200,{"Content-Type":"application/json;charset=utf-8"},"{\"d\":{\"results\":[]}}");}});o.setRequests(r);o.start();},createMockServerForFeatureToggleService:function(){var o=new M({rootUri:"/sap/opu/odata/SAP/CA_FM_FEATURE_TOGGLE_STATUS_SRV/"});o.simulate(jQuery.sap.getModulePath(_+"localService/CA_FM_FEATURE_TOGGLE_STATUS_SRV",".xml"),{bGenerateMissingMockData:true,aEntitySetsNames:[]});o.start();},getMockServer:function(){if(!m){this.init();}return m;}};});
